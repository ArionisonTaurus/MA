%!TEX root = DieLoesungAllerMilleniumsprobleme.tex
\chapter{Dichte Paare o-minimaler Strukturen}
\section{Allgemeine Betrachtungen und Anforderungen an die Theorien}

Viele Techniken und Gedanken aus dem vorigen Kapitel werden jetzt auf o-minimale Theorien übertragen: Im Folgenden halten wir einfach eine vollständige o-minimale Theorie T in der Sprache $\lingua$ fest und betrachten die Theorie $\tq$ in der Sprache $\lingua_P:=\lingua\cup\{P(x)\}$, sodass die Modelle von $\tq$ Modelle von T sind und in jedem Modell $\fM$ die Menge $P(M)$ ebenfalls Modell von T ist. Schreibe so ein Paar dann auch als $(B,A)$ mit $A=P(B)$.\\
Wir setzen voraus, dass $T$ eine durch $+$ dicht und linear angeordnete abelsche Gruppe mit einem positiven Element $1$ beschreibt, sodass Definable Choice gilt. Dann sind die Skolemfunktionen definierbar und \OE\ ist $\lingua$ schon so eine definitorische Erweiterung, dass $T$ Quantorenelimination hat und universell axiomatisierbar ist (wobei bei einzelnen Theorien die Frage interessant wäre, welche Skolemfunktionen man dafür überhaupt hinzufügen muss). Außerdem seien alle Modelle genug saturiert, dass die üblichen Rechenregeln für die Dimension gelten.\\
Aus T universell mit Quantorenelimination folgt, dass Unterstrukturen von Modellen von T schon elementare Unterstrukturen sind. Also ist für jede Teilmenge $S$ eines Modells $\dcl(S)$ schon eine elementare Substruktur; zur Vereinfachung bezeichne in Zukunft $AB:=\dcl(A\cup B)$ für zwei Teilmengen $A,B$ eines Modells.\\
$P$ beschreibt also eine elementare Unterstruktur, mit $\td$ wird nun die Theorie beschrieben, die ausdrückt, dass $P$ eine dichte echte Unterstruktur ist (diese zwei Sachen oder deren Gegenteil müssen auf jeden Fall von der Theorie beschrieben werden, wenn sie vollständig sein soll). Klar ist dann, dass Unterstrukturen von $\td$ automatisch Modelle von $\tq$ sind.\\
Dem Verlauf in \cite{VanDenDries} folgend, wird zunächst die Vollständigkeit und eine Art von Quantorenelimination für $\td$ gezeigt, wofür aber eine genauere Betrachtung von sogenannten kleinen Mengen vonnöten ist.

\section{Kleine Mengen}
\begin{definition}
	Sei $(B,A)\models\td$, dann ist eine $\lingua_P$-definierbare Menge $S\subseteq B$ \textbf{klein}, wenn eine $\lingua$-definierbare Funktion $f:B^n\rightarrow B$ existiert mit $S\subseteq f(A^n)$.
\end{definition}

Das Ziel ist jetzt, zu zeigen, dass definierbare Intervalle nicht klein sind.\newpage
Im folgenden Lemma meint $(\cdot,+)$ nicht unbedingt die Operationen in $\lingua$, sondern nur irgendwelche definierbaren Verknüpfungen.

\begin{lemma}\label{Hilfsaussage Kleinheit}
	Seien $A\prec B\models\operatorname{T},\ f:B^{n+1}\rightarrow B\ A\text{-definierbar},\ b\in B\setminus A,\ {\beta,\gamma\in A}$ mit $\beta<b<\gamma$ und einer angeordneten $A$-definierbaren Körperstruktur $(\cdot,+)$ auf $(\beta,\gamma)=:I$. Dann existieren $a_0,\dots,a_n\in I_A$ mit $$a_nb^n+a_{n-1}b^{n-1}+\dots,a_0\in I\setminus f(A^n\times\{b\}).$$
\end{lemma}
\begin{proof}
	Wenn die Aussage nicht gilt, dann gilt mit $p(x,y):=x_ny^n+x_{n-1}y^{n-1}+\dots,x_0$, dass für jedes $a\in (I_A)^{n+1}$ ein $\alpha\in A^n$ existiert mit $p(a,b)=f(\alpha,b)$. Es muss für festes $a\in I_A$ ein Intervall um $b$ in $I_A$ mit dieser Eigenschaft geben, denn sonst wäre $b\in\dcl(A)=A$.\\
	Sei jetzt $a$ nicht mehr fixiert, dann existiert mit Definable Choice eine definierbare Zuordnung $a\mapsto\alpha(a)$, sodass $p(a,\cdot)=f(\alpha(a),\cdot)$ auf einem Intervall gilt. Da jedes $a$ $n+1$ viele Einträge hat und jedes $\alpha(a)$ $n$ viele, müssen unendlich viele $a\in (I_A)^{n+1}$ existieren, die durch $\alpha$ auf das selbe Element abgebildet werden. Denn wenn das nicht so wäre, wäre ein generisches Element aus $(I_A)^{n+1}$ algebraisch über einem Element aus $A^n$, was der Generizität widerspricht. Da es unendlich viele Elemente gibt, sodass $\alpha$ auf ihnen konstant ist, gibt es schon eine Zelle von Dimension $>0$ mit der Eigenschaft und damit insbesondere eine Zelle $E$ von Dimension 1 (Als Teilmenge einer Zelle lässt sich immer eine von kleinerer Dimension finden). Nenne den konstanten Wert dann $\alpha^*$.\\
	Da also gilt: Für alle $a\in E$ existiert ein Intervall $J$ mit $p(a,\cdot)=f(\alpha^*,\cdot)$ auf $J$; existieren mit Definable Choice $\beta^*,\gamma^*:E\rightarrow I_A$, sodass $p(a,\cdot)=f(\alpha^*,\cdot)$ auf $(\beta^*(a),\gamma^*(a))$ gilt. \OE\ seien $\beta^*$ und $\gamma^*$ jetzt schon stetig auf $E$ und ein $e\in E$ beliebig· Dann existiert für $\varepsilon$ hinreichend klein eine $E$-Umgebung $U$ um $e$, sodass $$\beta^*<\frac{1}{2}(\beta^*(e)+\gamma^*(e))-\varepsilon,\ \frac{1}{2}(\beta^*(e)+\gamma^*(e))+\varepsilon<\gamma^*$$ auf $U$, also $$p(a,x)=f(\alpha^*,x)\text{ für alle }a\in U,x\in(\frac{1}{2}(\beta^*(e)+\gamma^*(e))-\varepsilon,\frac{1}{2}(\beta^*(e)+\gamma^*(e))+\varepsilon)$$ gilt. Es kann aber nicht $p(a-a',x)=p(a,x)-p(a',x)=f(\alpha^*,x)-f(\alpha^*,x)=0$ für $a,a'\in U$ verschieden und unendlich viele $x$ sein, weil ein Nichtnullpolynom nicht unendlich viele Nullstellen haben kann.
\end{proof}

\newpage

\begin{lemma}
	Sei $\fA$ eine o-minimale Erweiterung eines angeordneten Vektorraums über einem angeordneten Körper $F$ und $g:A^{p+1}\rightarrow A$ definierbar, außerdem existiere für unendlich viele $\lambda\in F$ ein $a_\lambda\in A^p$ mit $g(a_\lambda,x)=\lambda x$ für unendlich viele $x\in A$. Dann existiert ein Intervall $I$ in $A$, sodass auf $I$ eine $A$-definierbare Körperstruktur existiert, die mit $<$ kompatibel ist (was automatisch einen reell abgeschlossenen Körper impliziert).
\end{lemma}
\begin{proof}
	TODO: Geht irgendwie aus \cite{PeterStarch} hervor.
\end{proof}

\begin{lemma}
	Es sei $(A,B)\models\td,\ f:B^{n+1}\rightarrow B$ $A$-definierbar in $B$ und $b\in B\setminus A$. Dann enthält $f(A^n\times\{b\})$ kein Intervall um $b$.
\end{lemma}
\begin{proof}
	Nimm an, dass das Gegenteil gelte für das Intervall $J$ (\OE\ mit Randpunkten in $A$): Dann existiert insbesondere für jedes $q\in\setQ$ hinreichend nahe bei $1$ ein $a_q\in A^n$ mit $f(a_q,b)=qb$. Dann existiert wieder ein Intervall $I_q\subseteq J_A$ mit $f(a_q,x)=qx$ für alle $x\in I_q$. \OE\ ist dieses Intervall schon beschränkt und die Randpunkte seien $c_q<d_q$. Definiere dann $$r_q:=\frac{c_q+d_q}{2},s_q:=\frac{d_q-c_q}{2}\in A,$$ $$g:(u,v,x)\mapsto f(u,v+x)-f(u,v)\ \ \ \ u\in A^n,v,x\in A.$$
	Dann gilt für alle $x\in(-s_q,s_q)$ $$g(a_q,r_q,x)=f(a_q,r_q+x)-f(a_k,r_q)=q(r_q+x)-qr_q=qx.$$
	Also existiert nach dem letzten Lemma ein Intervall in $A$ mit einer $A$-definierbaren Körperstruktur als RCF. Durch Translation (benutze Dichtheit) nehme an, dass $b\in I_B$ liegt. Dann existiert nach Lemma \ref{Hilfsaussage Kleinheit} ein Element $c\in I_B\setminus f(A^n\times\{b\})$. \OE\ sei schon $\inf J,\sup J\in I$, sonst ersetze $J$ durch ein kleineres Intervall.\\
	Seien $d,e\in I$ mit $d<c<e$ und $\varphi$ die orientierungserhaltende, $A$-definierbare affine Abbildung in $I$ mit $\varphi(d)=\inf J,\varphi(e)=\sup J$. Dann ist $\varphi(c)\in J\setminus(\phi\circ f)(A^n\times\{b\})$ und da das Verketten mit einer $A$-definierbaren invertierbaren Abbildung nichts an der Aussage ändert, gibt es einen Widerspruch.
\end{proof}

\newpage

\begin{theorem}\label{Kleinheit}
	Wenn $(B,A)\models\td$, dann ist kein Intervall eine kleine Teilmenge.
\end{theorem}
\begin{proof}
	Sei $f:B^n\rightarrow B$ eine durch $\varphi(x,y,b)$ definierbare Abbildung mit $\varphi$ eine\linebreak$\lingua_A$-Formel und $b\in B^m$ für ein $m\in\setN$ definiert. Für $\dim(b/A)=0$ ist $f(A^n)\subseteq A$ klar, deswegen sei \OE\ $\dim(b/A)\geq1$. Definiere
	\begin{align*}
	g(x,z):=\left\{\begin{array}{ll}
	\text{das eindeutige }y\in B &\text{für alle z, für die }\varphi(x,y,z)\\
	\text{ mit }B\models\varphi(x,y,z) &\text{ bei festem }\text{ eine Funktion definiert}\\
	\ &\ \\
	0 &\text{sonst}
	\end{array}\right.,
	\end{align*}
	Dann ist $g$ in $B$ $A$-definierbar und $g(\cdot,b)=f$. Falls $\dim(b/A)>1$, füge genug Komponenten von $b$ zu $A$ hinzu, sodass $\dim(b/A)=1$. Das Hinzufügen ändert nichts, denn $Ab_i$ ist nach den Eingangsbemerkungen Modell von T und $Ab_i$ ist erst recht dicht in, aber nicht gleich $B$ (sonst hätte man die Dimension mit diesem Schritt schon zu sehr verkleinert).\\
	Finde also $b_i$, sodass $A$-definierbare $(h_j)$ existieren mit $b_j=h_j(b_i)$ für alle $j$. Wenn jetzt $J\subseteq f(A^n)=g(A^n,b)=g(A^n,h(b_i))$ für ein Intervall $J$, dann widerspricht das der Aussage des letzten Lemmas für die Funktion $(x,y)\mapsto g(x,h(y))$.
\end{proof}

\begin{definition}
	Schreibe ab jetzt $P(\overline{x}):=\bigwedge\limits_{i=1}^\abs{x}P(x_i)$.
\end{definition}

\begin{lemma}
	Wenn $(B,A)$ für ein unendliches $\kappa>\abs{\operatorname{T}}$ ein $\kappa$-saturiertes Modell von $\td$ ist, ist $\dim(B/A)\geq\kappa$.
\end{lemma}
\begin{proof}
	Sei $S$ eine Basis von $B/A$ mit $\abs{S}<\kappa$; zeige nun, dass es kein Erzeugendensystem sein kann. Das folgt aus der Saturation angewandt auf den partiellen Typen $$\{\forall\overline{y}\in P(x\neq t(\overline{y}))\mid t\ \lingua_E\text{-Term}\},$$ der endlich erfüllbar ist, weil die Negation jeder dieser Formeln \glqq{}$x$ ist in einer kleinen Menge\grqq{} impliziert. Wenn der Typ also nicht endlich erfüllbar wäre, würde eine endliche Vereinigung von kleinen Mengen ganz $B$ überdecken. Das kann aber nicht gelten, denn eine endliche Vereinigung von kleinen Mengen ist wieder klein (in der das bezeugenden Abbildung kann man das durch Erhöhen der Dimension des Urbildes und Fallunterscheidung über eine Koordinate beweisen).
\end{proof}
\newpage
\begin{corollary}\label{Finden transz Elte}
	Der Beweis zeigt sogar, dass in einem $\kappa$-saturiertem Modell $(B,A)\models\td$, gegeben Menge, $S,S',S''\subset B$ mit $\abs{S},\abs{S'},\abs{S''}<\kappa$, ein transzendentes Element $b$ über $SA$ gefunden werden kann mit $a<b$ für alle $a\in S'$ und $b<c$ für alle $c\in S''$, sofern dieser Ordnungstyp von $b$ überhaupt konsistent ist.
\end{corollary}

\section{Formelreduzierung in $\td$}
In diesem Abschnitt wird gezeigt, dass sich $\lingua_P$-Formeln modulo $\td$ sehr stark vereinfachen lassen. Indem dieses mit einem Back\&Forth-System gezeigt wird, erhält man zusätzlich eine sehr große Klasse von elementaren Abbildungen zwischen Modellen von $\td$.\\
In diesem Kontext wird wieder die $\acl$-Unabhängigkeit in einem Modell von T relevant, die im ersten Kapitel mit \glqq{}algebraisch disjunkt\grqq{} bezeichnet wurde. Man kann sich dafür folgende (teilweise schon bekannte) Fakten überlegen.

\begin{lemma}\label{Unabhängigkeitsregeln}
	Seien $A,B,C,D$ Mengen in irgendeinem Modell von $T$.
	\begin{enumerate}
		\item Wenn $A$ und $B$ unabhängig über $C$ sind, sind $B$ und $A$ unabhängig über $C$ und $A\cap B\subseteq\acl(C)$ (in fast allen betrachteten Fällen wird sowieso $A,B\supseteq C$ und $C=\acl(C)$ gelten).
		\item Wenn $A$ und $B$ unabhängig über $C$ sind und $S\subseteq B$, dann sind auch $A\cup S$ und $B$ unabhängig über $C\cup S$.
		\item Wenn $A$ und $B$ unabhängig über $C$ sind, $A\subseteq S\subseteq\acl(A),B\subseteq S'\subseteq\acl(B)$, dann sind $S$ und $S'$ unabhängig über $C$.
		\item Wenn $A$ und $B$ unabhängig über $C$ sind und $D$ (algebraisch) unabhängig über $AB$, dann sind $A\cup D$ und $B$ unabhängig über $C$.
		\item Wenn $(D,C)\preceq(B,A)\models\tq$, dann sind $A$ und $D$ unabhängig über $C$.
		\item Wenn $(D,C)\subseteq(B,A)\models\tq,\ S\subseteq A$ und $A$ und $D$ unabhängig über $C$ sind, dann sind $A$ und $DS$ unabhängig über $CS$, $\langle D\cup S\rangle_{\lingua_P}=(DS,CS)$ und $$(D,C)\subseteq(DS,CS)\subseteq(B,A).$$
		\item Wenn $(D,C)\subseteq(B,A)\models\tq$ und $S\subseteq B$ unabhängig über $DA$ ist, dann sind $A$ und $DS$ unabhängig über $C$, $\langle D\cup S\rangle_{\lingua_P}=(DS,C)$ und $$(D,C)\subseteq(DS,C)\subseteq(B,A).$$
	\end{enumerate}
\end{lemma}
\newpage
\begin{proof}
	1.-4. sind bekannt.
	\item[5.] Wenn $\overline{d}\in D$ algebraisch unabhängig über $C$ ist, aber nicht über $A$, dann existiert eine $\lingua_A$-Formel $\varphi(\overline{x},\overline{a})$, sodass \OE\ $d_1$ von $\varphi(x_1,d_2,d_3\dots,\overline{a})$ algebraisiert wird (\OE\ wird $d_1$ schon durch $\varphi$ definiert). Also erfüllt $\overline{d}$ die $\lingua_P$-Formel $$\exists \overline{y}\in P(\varphi(\overline{x},\overline{y})\land\forall z_2,z_3,\dots\exists! z_1(\varphi(\overline{z},\overline{y})))$$ in $(B,A)$, also auch in $(D,C)$. Es existiert also $\overline{c}\in C$ mit $$B\models\varphi(\overline{d},\overline{c})\land\forall z_2,z_3,\dots\exists! z_1(\varphi(\overline{z},\overline{c})),$$ was im Widerspruch zur Unabhängigkeit von $\overline{d}$ über $C$ steht.
	\item[6.] Dass $A$ und $DS$ unabhängig über $CS$ sind, ergibt sich in der Kombination von 2. und dann 3.\\
	Dass die Trägermenge von $\langle D\cup S\rangle_{\lingua_P}$ die Menge $DS$ ist, ergibt sich direkt per Definition als $DS=\dcl(D\cup S)=\langle D\cup S\rangle_\lingua$. Weil $A$ und $DS$ unabhängig über $CS$ sind, folgt $$P(\langle D\cup S\rangle_{\lingua_P})=DS\cap P(B)=DS\cap A=CS.$$
	\item[7] Es ergibt sich aus 4. und 3. dass $A$ und $DS$ unabhängig über $CS$ sind. Der Rest geht analog zu 6.
\end{proof}

Zu bemerken ist, dass ein Spezialfall von Unabhängigkeit viele nützliche Eigenschaften hat. Auf diesen wird später noch oft zurückgegriffen werden.
\begin{definition}
	Seien $(D,C)\subseteq(B,A)$ zwei Modelle von $\tq$. Dann heiße diese Erweiterung \textbf{frei}, wenn $D$ und $A$ unabhängig über $C$ sind.
\end{definition}

\begin{lemma}\label{Kodichte von A}
	Sei $(B,A)\models\td$. Dann ist $A$ auch kodicht in $B$.
\end{lemma}
\begin{proof}
	Zu zeigen ist, dass für alle $a,c\in B$ ein $b\in B\setminus A$ existiert mit $a<b<c$. Durch Translation und Inversion kann man annehmen, dass $a=0$. Wähle jetzt ein $d\in B\setminus A$ beliebig und $e\in A$ mit $d-c<e<d$. Dann ist $d-e$ nicht in $A$ (denn sonst wäre es $d$) und $0=e-e<d-e<d-(d-c)=c$.
\end{proof}

\newpage
Für die Konstruktion des gewünschten Back\&Forth-Systems sei $\kappa>\abs{T}$ eine beliebige, aber feste Kardinalzahl und $(B,A),(D,C)\models\td$ zwei $\kappa$-saturierte Modelle.
\begin{theorem}\label{BackForth}
	Sei $S$ die Menge aller partiellen Isomorphismen zwischen Unterstrukturen $(B',A')$ von $(B,A)$ und $(D',C')$ von $(D,C)$ der Mächtigkeit $<\kappa$, sodass die Erweiterungen frei sind. Dann bildet $S$ ein nichtleeres B\&F-System und $\td$ ist insbesondere vollständig.
\end{theorem}
\begin{proof}
	Das System ist nichtleer, denn es gibt ein Primmodell $\fM$ von $T$, weil $T$ vollständig ist und in jedem Modell $A$ alle Eigenschaften von $\fM_A:=\langle\emptyset\rangle_\lingua$ in $T$ beschrieben werden. Klarerweise ist $\abs{M}=\abs{T}<\kappa$. Der Isomorphismus $(\fM_A,\fM_A)\cong(\fM_C,\fM_C)$ liegt in $S$, denn Unabhängigkeit ist bei zwei gleichen Mengen offensichtlich.\\
	Sei jetzt $S\ni i:(B',A')\rightarrow(D',C')$ und $b\in B$. Wenn $b\in B'$ ist, ist nichts zu zeigen. Wenn $b\in A\setminus B'$, betrachte den partiellen Typ $$\{\alpha<x\mid i^{-1}(\alpha)<b\}\cup\{x<\beta\mid b<i^{-1}(\beta)\}\cup\{P(x)\}.$$
	Dieser ist konsistent, da $i$ ein Isomorphismus ist und $C$ dicht in $D$; mit Saturation existiert ein $d\in C\setminus D'$ mit diesem Ordnungstyp. $i$ setzt sich dann eindeutig zu einem Isomorphismus $i':(B'b,A'b)\rightarrow(D'd,C'd)$ mit $i(b)=d$ fort, der gegeben ist durch die Abbildung $t(b)\mapsto i(t)(d)$ für $t$ einen $\lingua_{B'}$-Term und $i(t)$ den durch $i$ geshifteten Term. Die Surjektivität dieser Abbildung ist klar, ebenso dass $i'(A'b)=C'd$. Wohldefiniertheit, Injektivität und Isomorphismuseigenschaft gelten, denn:\\
	$Rt_1(b)\dots t_n(b)$ gilt für $\lingua_{B'}$-Terme $t_1,\dots,t_n$ und eine Relation $R$ genau dann, wenn es ein $B'$-definierbares Intervall $I$ um $b$ mit dieser Eigenschaft gibt (denn sonst wäre $b$ definierbar über $B'$ und somit in $B'$). Schickt man $I\cap B'$ mit $i$ nach $J:=i(I\cap B')$, so gilt für alle Elemente $z\in J$, dass $Ri(t_1)(z)\dots i(t_n)(z)$, da $i$ ein Isomorphismus ist. Wäre jetzt nicht $Ri(t_1)(d)\dots i(t_n)(d)$, so gäbe es ein $D'$-definierbares Intervall $I'$ um $d$, sodass das nicht gilt; insbesondere ist $I'$ disjunkt zu $J$. Allerdings ist $$b\in I'\cap\operatorname{convex}(J)=I'\cap(i(\inf I),i(\sup I)),$$ also können $I'$ und $J$ nicht disjunkt sein. Es gilt also $Ri(t_1)(d)\dots i(t_n)(d)$.\\
	Die Rückrichtung geht analog.\\
	Zu zeigen ist nun, dass $B'b$ und $A$ frei über $A'b$ sowie $D'd$ und $C$ frei über $C'd$ sind, ebenso zu zeigen ist noch, dass $(B'b,A'b)\subseteq(B,A),(D'd,C'd)\subseteq(D,C)$. Das alles folgt aber aus Lemma \ref{Unabhängigkeitsregeln} (6.). Außerdem gilt $\abs{D'd}=\abs{B'b}=\abs{B'}+\abs{T}<\kappa$.\\
	Sei jetzt $b\in B'A\setminus(A\cup B')$. Dann gibt es $\overline{a}\in A$ mit $b\in B'\overline{a}$. Erweitere wie schon bekannt $i$, sodass $\overline{a}\in\operatorname{dom}(i)$; dann ist schon ganz $B'\overline{a}\subseteq\operatorname{dom}(i)$, also auch $b$.\\
	Abschließend sei $b\in B\setminus B'A$;  wie oben erfülle dann den mit $i$ geshifteten Ordnungstyp von $b$ über $B'$ mit einem Element $d\in D\setminus D'C$ (mit Folgerung \ref{Finden transz Elte} geht das). Wie oben kann $i$ dann auf einen Isomorphismus $(B'b,A')\rightarrow(D'd,C')$ fortgesetzt werden und nach Lemma \ref{Unabhängigkeitsregeln} (7.) erfüllen $(B'b,A'),(D'd,C')$ auch die hinreichenden Eigenschaften.
\end{proof}

Dieses B\&F-System beweist die Formelreduzierung in $\td$.
\begin{theorem}
	Jede $\lingua_P$-Formel ist modulo $\td$ äquivalent zu einer booleschen Kombination von Formeln der Gestalt
	$$\exists\overline{y}\in P(\phi(\overline{x},\overline{y}))$$
	für $\phi$ eine $\lingua$-Formel. Nenne eine solche boolesche Kombination eine \textbf{gute Formel} und eine Formel der Gestalt wie beschrieben eine \textbf{gute Formel in Reinform}.
\end{theorem}
\begin{proof}
	\underline{Hilfsaussage:}\\
	Es reicht zu zeigen, dass für alle Modelle $(B,A),(D,C)\models\td$ und für alle $b\in B^n,d\in D^n$ gilt: Wenn $b$ und $d$ dieselben guten Formeln erfüllen, sind ihre Typen in $(B,A)$ und $(D,C)$ dieselben.\\
	Dass dies ausreicht, erkennt man mit dem Ziegler'schen Trennungslemma: Sei $\psi\in\fF_n(\lingua_P)$ nicht äquivalent zu einer guten Formel und nenne die Menge aller guten Formeln in $n$ freien Koordinaten $K$. Dann ist $K$ abgeschlossen unter $\land,\lor$ und enthält $\top,\bot$. Wenn $\psi$ nicht äquivalent zu einer Formel aus $K$ ist, sind $\td\cup\{\psi\}$ und $\td\cup\{\neg\psi\}$ nicht durch $K$ trennbar, also existieren $(B,A),(D,C)\models\td,b\in B^n,d\in D^n$, sodass $(B,A)\models\psi(b)$ und $(D,C)\models\neg\psi(d)$, aber $(B,A)\models\chi(b)$ genau dann, wenn $(D,C)\models\chi(d)$ für alle $\chi\in K$. Dann erfüllen $b$ und $d$ dieselben guten Formeln, aber haben nicht denselben Typ - ein Widerspruch!\\
	\begin{proof}[Beweis der Hilfsaussage]
		Seien $b,d$ wie verlangt und $(B,A),(D,C)$ schon \OE\linebreak $\abs{T}^+$-saturiert (das ändert nichts an Typen und dem Erfüllen von guten Formeln). Sei $a\in A^m$ für ein hinreichend großes $m$, mit der Eigenschaft dass $\dim(b/a)\leq\dim(b/A)$ (es folgt dann Gleichheit, da über einer kleineren Menge nicht mehr interdefinierbar werden kann). Für $A':=\dcl(a),B':=\dcl(a,b)$ gilt dann, dass $A$ und $B'$ unabhängig über $A'$ sind. Es sind nämlich per Definition von $a$ die Mengen $A$ und $b$ unabhängig über $a$ (eben wegen $\dim(b/a)=\dim(b/A)$), mit Lemma \ref{Unabhängigkeitsregeln} (2.) sind dann auch $A$ und $b\cup(A')$ unabhängig über $A'$ und mit 3. sind $A$ und $B'=\dcl(b\cup A')$ unabhängig über $A'$. Außerdem sind $A'$ und $B'$ maximal $\abs{T}$ groß.\newpage
		Wenn man den partiellen $\lingua_P$-Typ $\tp_\lingua(a/b)\cup\{P(\overline{x})\}$ betrachtet, bleibt er konsistent unter der Ersetzung $b\rightarrowtail d$ in den Formeln. Seien nämlich $\psi_1(\overline{x},b),\dots,\psi_n(\overline{x},b)\in\tp_\lingua(a/b)$, dann ist $$\exists\overline{x}\in P(\bigwedge\limits_{i=1}^n\psi_i(\overline{x},\overline{y}))$$ eine gute Formel, die von $b$ und daher auch von $d$ erfüllt wird. Also ist der ersetzte partielle Typ endlich konsistent, wegen Saturation habe er den Erfüller $c\in C$ und es gilt $\tp_\lingua(a,b)=\tp_\lingua(c,d)$. Wegen der Typengleichheit folgt insbesondere $\dim(b/a)=\dim(d/c)$; es bleibt noch zu zeigen, dass $\dim(b/A)=\dim(d/C)$, damit dann gilt $\dim(d/C)=\dim(b/A)=\dim(b/a)=\dim(d/c)$ und wie oben $C$ und $D':=\dcl(c,d)$ frei über $C':=\dcl(c)$ sind. Die Gleichheit $\dim(b/A)=\dim(d/C)$ gilt aber, da für jede $\lingua$-Formel $\psi$ und $j_1,\dots,j_n\in\setN$ die Formel zu $$\glqq{}\text{es existiert }\overline{y}\in P\text{, sodass }\psi(\overline{x},\overline{y})\ x_i\text{ über }x_{j_1},\dots,x_{j_m}\text{ definiert}\grqq{}$$ eine gute Formel ist, die also genau dann von $b$ erfüllt wird, wenn sie von $d$ erfüllt wird.\\
		Da $(a,b)$ und $(c,d)$ den gleichen $\lingua$-Typ haben, gibt es einen partiellen Isomorphismus $i$ von $B'=\dcl(a,b)$ nach $D'=\dcl(c,d)$ mit $i((a,b))=(c,d)$, die Einschränkung auf $A'=\dcl(a)$ bildet einen Isomorphismus nach $C'=\dcl(c)$. Also ist $i$ partieller Isomorphismus $(B,A)\rightarrow(D,C)$, damit im B\&F-System, also elementare Abbildung, weswegen $b$ und $d$ denselben $\lingua_P$-Typen haben.
	\end{proof}
\end{proof}

\begin{corollary}\label{Definierbarkeit aus A}
	Für ein dichtes Paar $(B,A)$ und $S\subseteq B^n$ eine $A_0$-definierbare Menge in $\lingua_P$ (wobei $A_0\subseteq A$) ist $S\cap A^n$ eine $A_0$-definierbare Menge in $\lingua$.
\end{corollary}
\begin{proof}
	Nach der Formelreduzierung sei $S$ \OE\ durch eine gute Formel definiert. Da die Definierbarkeit abgeschlossen unter booleschen Kombinationen ist, reicht es, eine Formel in Reinform zu betrachten.\newpage
	Da aber für jede $\lingua_{A_0}$-Formel $\varphi(x,y,a')$ und jedes $a\in A^n$ die Aussagen $$\glqq{}\text{Es existiert ein }y\in A^m\text{ mit }(B,A)\models\varphi(a,y,a')\grqq{},$$ $$\glqq{}\text{Es existiert ein }y\in A^m\text{ mit }B\models\varphi(a,y,a')\grqq{},$$ $$\glqq{}\text{Es existiert ein }y\in A^m\text{ mit }A\models\varphi(a,y,a')\grqq{}$$ äquivalent sind wegen $\varphi$ als $\lingua$-Formel und $A\prec B$, folgt, dass $$\exists y\in P(\varphi(x,y,a'))(B)\cap A^n=\exists y(\varphi(x,y,a'))(A).$$
\end{proof}

\section{Folgen der Existenz des B\&F-Systems}
Im Folgenden werden einige Anordnungen von wechselseitigen Inklusionen von Modellen von T betrachtet, in der Gleichheit von bestimmten Typen folgt.

\begin{lemma}\label{freie Erweiterungen}
	Für dichte Paare $(B,A),(D,C)$ mit $(D,C)\subseteq(B,A)$ sind folgende Eigenschaften äquivalent:
	\begin{enumerate}
		\item $(D,C)\preceq(B,A)$
		\item Die Erweiterung ist frei.
	\end{enumerate}
\end{lemma}
\begin{proof}
	$\glqq{}1.\Rightarrow2.\grqq{}:$ Diese Richtung ist schon aus Lemma \ref{Unabhängigkeitsregeln} (5.) bekannt.\\
	$\glqq{}2.\Rightarrow1.\grqq{}:$ Finde $(\abs{B}+\abs{T})^+$-saturierte Strukturen $$(B,A)\preceq(B',A'),(D,C)\preceq(D',C');$$ es ist dann $(D,C)$ eine gemeinsame Unterstruktur und $(D,C)\subseteq(D',C')$ ist frei nach dem Beweis der Gegenrichtung. Außerdem sind nach Voraussetzung $D$ und $A$ unabhängig über $C$, da aber Unabhängigkeit von Tupeln in $D$ über $A$ auch über $A'$ erhalten bleibt (da $(B',A')$ elementare Oberstruktur), ist auch $(D,C)\subseteq(B',A')$ frei. Also ist die Identität auf $(D,C)$ im Back\&Forth-System, daher elementare Abbildung. Daraus folgt für alle $(\lingua_P)_D$-Formeln $\varphi$, dass $$(D,C)\models\phi\Leftrightarrow(D',C')\models\varphi\Leftrightarrow(B',A')\models\varphi\Leftrightarrow(B,A)\models\varphi.$$
\end{proof}

\begin{lemma}\label{Gemeinsame Unterstruktur}
	Seien $(B_1,A_1),(B_2,A_2)\models\td$ und $(B,A)$ eine gemeinsame Unterstruktur, sodass die Inklusionen frei sind. Wenn $a\in (A_1)^n$ und $b\in (A_2)^n$ denselben $\lingua$-Typen über $B$ erfüllen, erfüllen sie auch denselben $\lingua_P$-Typen über $B$.
\end{lemma}
\begin{proof}
	\OE\ seien $(B_1,A_1)$ und $(B_2,A_2)$ schon genügend saturiert, das ändert nichts an Typen über $B$ und (nach derselben Argumentation wie im vorigen Lemma) auch nichts an der Unabhängigkeit. Da $a$ und $b$ denselben Typen über $B$ erfüllen, kann man wieder $\lingua_B$-Terme mit eingesetztem $a$ auf $\lingua_B$-Terme mit eingesetztem $b$ abbilden (Wohldefiniertheit und Injektivität wird durch die Typengleichheit ermöglicht) und bekommt einen partiellen Isomorphismus $i:Ba\cong Bb$, dessen Einschränkung auf die $\lingua_A$-Terme einen partiellen Isomorphismus $Aa\cong Ab$ induziert und sodass $i(a)=b$. Also gilt $i:(Ba,Aa)\cong(Bb,Ab)$, da außerdem die Erweiterungen $(Ba,Aa)\subseteq(B_1,A_1)$ und $(Bb,Ab)\subseteq(B_2,A_2)$ frei sind nach Lemma \ref{Unabhängigkeitsregeln} (6.), ist $i$ im Back\&Forth-System, also elementar, also haben $a$ und $b$ denselben $\lingua_P$-Typen über $B$.
\end{proof}

\begin{corollary}
	Wenn man sich solch ein Paar $(a,b)$ beliebig wählt (z.B. $a=b=0$), sind in dem Typen auch die parameterfreien $(\lingua_P)_B$-Formeln, die in $(B_1,A_1)$ bzw. $(B_2,A_2)$ gelten. Also gelten dieselben Formeln, was als $(B_1,A_1)\equiv_B(B_2,A_2)$ geschrieben wird.
\end{corollary}

\begin{lemma}\label{selber Schnitt}
	Seien $(B_1,A_1),(B_2,A_2)$ zwei dichte Paare und $A\subseteq A_1\cap A_2$ eine gemeinsame Substruktur, sowie $a\in B_1\setminus A_1,\ b\in B_2\setminus A_2$, die den gleichen Ordnungstyp über $A$ haben. Dann haben $a$ und $b$ sogar den gleichen $\lingua_P$-Typ über $A$.
\end{lemma}
\begin{proof}
	Es sind trivialer Weise $A_i$ und $A$ unabhängig über $A$ für $i=1,2$, außerdem ist $a$ transzendent über $A_1$ und $b$ transzendent über $A_2$. Nach Lemma \ref{Unabhängigkeitsregeln} (4.) sind also die Einbettungen $(Aa,A)\subseteq(B_1,A_1)$ und $(Ab,A)\subseteq(B_2,A_2)$ frei. Nach dem Beweis zu Satz \ref{BackForth} gibt es also einen Isomorphismus $Aa\cong Ab$, der $A\cong A$ fortsetzt und für den $i(a)=b$ gilt, also gibt es einen Isomorphismus $i:(Aa,A)\cong(Ab,A)$.\\ Wenn \OE\ die beiden Modelle von $\td$ genügend saturiert sind, ist $i$ im B\&F-System, also erfüllen $a$ und $b$ dieselben Formeln.
\end{proof}

\newpage

\section{Definierbare Teilmengen von $A^n$}
Wir interessieren uns für die Gestalt von $\lingua_P$-definierbaren Teilmengen von $A^n$. Dafür braucht man zuerst eine Hilfsaussage für definierbare Mengen in o-minimalen Strukturen.

\begin{lemma}
	Sei $\fM$ eine o-minimale Struktur, die eine angeordnete Gruppenoperation $+$ mit positivem Element 1 hat und $Y\subseteq M^n$ definierbar. Dann ist $Y$ eine endliche Vereinigung von Mengen der Form $\{f(b,\cdot)=0,g(b,\cdot)>0\}$, wobei $b\in M^m$ und $f,g$ stetige, 0-definierbare Abbildungen $M^{m+n}\rightarrow M$ sind.
\end{lemma}
\begin{proof}
	Schreibe $Y=\phi(b,\fM)$ für ein $b\in M^m$ und definiere $Z:=\phi(\fM)$. Wenn man $Z$ in Zellen $(Z_i)_i$ zerlegt, erhält man $Y$ als endliche Vereinigung von $((Z_i)_b)_i$.  Es sei also o.B.d.A. $Z$ schon eine 0-definierbare Zelle.\\
	Definiere $$f(x):=\left\{\begin{array}{ll}
	\inf\{\abs{x-d}\mid d\in Z\}&Z\text{ nichtleer}\\
	1&\text{sonst}
	\end{array}\right.,$$
	$$g(x):=\left\{\begin{array}{ll}
	\inf\{\abs{x-d}\mid d\in \overline{Z}\setminus Z\}&Z\text{ nichtleer}\\
	1&\text{sonst}
	\end{array}\right.,$$ das sind lipschitzstetige Funktionen.\\
	Klar ist, dass $\overline{Z}=\{f=0\}$; da Zellen lokal abgeschlossen sind, ist $\overline{Z}\setminus Z=\overline{\overline{Z}\setminus Z}=\{g=0\}$. Also erhalten wir $$Z=\overline{Z}\setminus(\overline{Z}\setminus Z)=\{f=0\}\setminus\{g=0\}=\{f=0\}\cap\{g>0\}$$ und $$Y=Z_b=\{f(b,\cdot)=0\}\cap\{g(b,\cdot)>0\}.$$
\end{proof}

\begin{theorem}\label{Definierbare Mengen}
	Für ein dichtes Paar $(B,A)$ und $Y\subseteq A^n$ ist folgendes äquivalent:
	\begin{enumerate}
		\item $Y$ ist $\lingua_P$-definierbar.
		\item Es existiert ein $\lingua$-definierbares $Z\subseteq B^n$, sodass $Y=Z\cap A^n$.
		\item $Y$ ist definierbar in $(A,(R_b)_{b\in B})$ mit der Interpretation $A\models R_b(a)$ genau dann, wenn $0<a<b$ in $B$.
	\end{enumerate}
\end{theorem}
\newpage
\begin{proof}
	$\glqq{}1.\Rightarrow 2.\grqq{}:$ Sei $\varphi$ eine $(\lingua_P)_B$-Formel mit $\varphi(B)=Y$. Zu zeigen ist, dass eine $\lingua_B$-Formel $\psi$ existiert mit $(B,A)\models P(x)\rightarrow(\varphi(x)\leftrightarrow\psi(x))$; das ist genau dann der Fall, wenn $\mathfrak{Th}(B,A)_B\cup\{P(x)\}\cup\{\varphi(x)\}$ und $\mathfrak{Th}(B,A)_B\cup\{P(x)\}\cup\{\neg\varphi(x)\}$ in $\lingua_B$ getrennt werden können. Nach dem Trennungslemma gilt das genau dann, wenn für alle $(B,A)\preceq(D_1,C_1),(D_2,C_2)$ und alle $c_i\in C_i\ (i=1,2)$ mit $(D_1,C_1)\models\varphi(c_1),(D_2,C_2)\models\neg\varphi(c_2)$ eine $\lingua_B$-Formel $\chi$ existiert mit $(D_1,C_1)\models\chi(c_1),(D_2,C_2)\models\neg\chi(c_2)$.\\
	Seien solche $(D_i,C_i)$ und $c_i$, die die Voraussetzungen von oben erfüllen. Dann ist das die Situation aus Lemma \ref{Gemeinsame Unterstruktur}, denn elementare Erweiterungen sind frei. Also muss ein trennendes $\chi$ wie verlangt existieren, denn ansonsten würden $c_1$ und $c_2$ denselben $\lingua$-Typ erfüllen, aber nicht denselben $\lingua_P$-Typ.\\
	$\glqq{}2.\Rightarrow 3.\grqq{}:$ Sei $Y=Z\cap A^n$. Nach dem letzten Lemma ist $Z$ eine boolesche Kombination aus Mengen der Form $\{f(b,\cdot)=0\}$ und $\{g(b,\cdot)>0\}$ für stetige 0-$\lingua$-definierbare Funktionen $f,g$ und passende $b\in B^m$. Es reicht also die Aussage für Mengen in diesen Formen zu zeigen. Wegen der Stetigkeit der Funktionen und $A$ dicht in $B$ gilt aber in $B$
	\begin{align*}
	f(b,z)=0\Leftrightarrow\ &\text{Für alle }0<\varepsilon\in A\text{ existiert }A^m\ni a<b\text{ (koordinatenweise),}\\&\text{sodass für alle }a'\in A^m\text{ mit }a<a'<b\text{ (koordinatenweise)}\\&\text{gilt, dass }\abs{f(a',z)}<\varepsilon,\\
	g(b,z)>0\Leftrightarrow\ &\text{Es existiert ein }0<\varepsilon\in A\text{ und ein }A^m\ni a<b\text{ (koordinatenweise),}\\&\text{sodass für alle }a'\in A^m\text{ mit }a<a'<b\text{ (koordinatenweise)}\\&\text{gilt, dass }\abs{f(a',z)}>\varepsilon.
	\end{align*}
	Die rechten Bedingungen sind jeweils in $(A,(R_b)_{b\in B})$ definierbar.\\
	$\glqq{}3.\Rightarrow 1.\grqq{}:$ Da $A$und alle $R_b$ in $(B,A)$ definierbar sind, ist $Y$ auch in $(B,A)$ definierbar.
\end{proof}

\section{Definierbare Funktionen}
Um definierbare Funktionen besser zu verstehen, ist es notwendig, sich mit dem definierbaren Abschluss zu beschäftigen.

\begin{lemma}\label{A definierbar abgeschl}
	In jedem dichten Paar $(B,A)$ ist $A$ definierbar abgeschlossen.
\end{lemma}
\begin{proof}
	Sei $b\in B\setminus A$ und $(B,A)\preceq(D,C)$ eine genügend saturierte Erweiterung. Dann wird der Ordnungstyp von $b$ über $A$ auch von einem Element $D\setminus C\ni d\neq b$ realisiert wegen Dichtheit von $D\setminus C$ in $D$ und Saturation.\newpage
	Nach Lemma \ref{selber Schnitt} haben $b$ und $d$ dann den selben $\lingua_P$-Typen über $A$, weswegen $b$ nicht definierbar über $A$ in $(D,C)$ sein kann, also auch nicht in $(B,A)$.
\end{proof}

\begin{corollary}
	Sei $(B,A)$ ein dichtes Paar und $A_0\preceq A$. Dann ist $A_0$ definierbar abgeschlossen.
\end{corollary}
\begin{proof}
	Sei $b$ definierbar über $A_0$. Dann ist $b$ insbesondere definierbar über $A$, also in $A$. Nach Folgerung \ref{Definierbarkeit aus A} ist dann $\{a\}=\{a\}\cap A$ schon $\lingua$-definierbar aus $A_0$, also in $A_0$, da $A_0$ elementare Substruktur ist.
\end{proof}

\begin{lemma}\label{Freie Definierbarkeit}
	Sei $(D,C)\subseteq(B,A)$ frei und $(B,A)$ dichtes Paar. Dann ist $D$ definierbar abgeschlossen in $(B,A)$.
\end{lemma}
\begin{proof}
	Wenn $D=C$, ist $D\preceq A$ und die Aussage daher klar nach der vorigen Folgerung. Die Erweiterung $(AD,A)\subseteq(B,A)$ ist trivialerweise frei (zwei gleiche Mengen in der Unabhängigkeit), außerdem ist $A\preceq AD$ dicht (da $A$ dicht in $B\supseteq AD$) und eine echte Inklusion, da für $D=A$ wegen Unabhängigkeit von $D$ und $A$ ansonsten $D=C$ folgen würde. Nach Lemma \ref{freie Erweiterungen} ist also $(AD,A)\preceq(B,A)$ und daher ist $\dcl(D)\subseteq\dcl(AD)=AD$, da $AD$ definierbar abgeschlossen nach Lemma \ref{A definierbar abgeschl}.\\
	Sei jetzt $d\in AD$ $\lingua_P$-definierbar über $D$ und $a\in A^n$ minimal mit $d\in Da$ (insbesondere ist $a$ unabhängig über $D$). Im Folgenden wird gezeigt, dass dann $a$ schon das leere Tupel, also $d\in D$ ist.\\
	Nimm an, dass $n>0$ und sei $f:B^n\rightarrow B$ die definierende Funktion von $d$, also ist sie $D$-definierbar und $f(a)=d$. Seien $$S_1:=\{x\in B^n\mid f(x_1,\dots,x_{n-1},\cdot)\text{ ist streng monoton wachsend auf einem Intervall um }x_n\},$$ $$S_2:=\{x\in B^n\mid f(x_1,\dots,x_{n-1},\cdot)\text{ ist streng monoton fallend auf einem Intervall um }x_n\},$$ $$S_3:=\{x\in B^n\mid f(x_1,\dots,x_{n-1},\cdot)\text{ ist konstant auf einem Intervall um }x_n\}.$$
	$S_1\cup S_2\cup S_3$ ist groß, denn wenn eine offene Menge $U\subseteq B^n\setminus(S_1\cup S_2\cup S_3)$ existiert, wähle $x\in U$ beliebig und ein Intervall $I$ um $x_n$ mit $\{(x_1,\dots,x_{n-1})\}\times I\subset U$. Nach der Charakterisierung o-minimaler definierbarer Funktionen existiert ein Subintervall $J\subseteq I$, sodass $f(x_1,\dots,x_{n-1},\cdot)$ entweder streng monoton wachsend, fallend oder konstant ist auf $J$. Also ist $x\in S_1\cup S_2\cup S_3$ im Widerspruch zu $x\in U$.\newpage
	Da $a$ generisch ist, muss es also in der großen Menge liegen.
	\begin{itemize}
		\item Wenn $a$ in $S_1$ liegt, nehmen wir an, dass $(B,A)$ schon hinreichend saturiert ist (das ändert nichts, da $(B,A)$ ja nur irgendeine Oberstruktur und Modell von $\td$ sein muss) und finden in $A\setminus Da_1\dots a_{n-1}$ ein $a'\neq a_n$ mit demselben Ordnungstyp über $Da_1\dots a_{n-1}$ (ansonsten wäre $a_n$ definierbar über $a_1,\dots,a_{n-1}$). Insbesondere ist $a_1,\dots,a_{n-1},a'\in S_1$, weil die Menge aller solchen Elemente $a'$ $Da_1\dots a_{n-1}$-definierbar ist und daher eine $Da_1\dots a_{n-1}$-definierbare Umgebung von $a_n$ dort drin liegt, in der $a'$ liegen muss. Da $f$ streng monoton ist, ist $f(a_1,\dots,a_{n-1},a')\neq f(a)=d\in D$.\\
		Allerdings ist $d$ $\lingua_P$-definierbar über $D$, also ist $$f(a_1,\dots,a_{n-1},x)=d\in\tp_{\lingua_P}(a/Da_1\dots a_{n-1})\setminus\tp_{\lingua_P}(a'/Da_1\dots a_{n-1})$$ (oder zumindest mit der definierenden Formel für $d$ eingesetzt), die Typen sind daher nicht gleich.\\
		Da $a_n,a'\in A$ aber den gleichen Ordnungstyp über $Da_1\dots a_{n-1}$ haben, haben sie auch den gleichen $\lingua$-Typ über $Da_1\dots a_{n-1}$ nach dem Beweis von Satz \ref{BackForth}. Außerdem ist $(Da_1\dots a_{n-1},Ca_1\dots a_{n-1})\subseteq(B,A)$ nach Lemma \ref{Unabhängigkeitsregeln} (6.) frei, weswegen aus Lemma \ref{Gemeinsame Unterstruktur} folgt, dass $a_n,a'$ denselben $\lingua_P$-Typ über $Da_1\dots a_{n-1}$ haben - Widerspruch!
		\item Das Fall $a\in S_2$ geht analog, es wurde eben auch nur streng monoton benutzt.
		\item Im Falle $a\in S_3$ ist $d$ $\lingua$-definierbar über $Da_1\dots a_{n-1}$ durch $$\glqq{}d=f(a_1,\dots,a_{n-1},x)\text{ für irgendein }(a_1,\dots,a_{n-1},x)\in S_3.$$
	\end{itemize}
\end{proof}

\fcolorbox{red}{red}{Ab hier müsst ihr (Stand 20.1.) nicht mehr korrekturlesen. (TODO: Entfernen, wenn unnötig)}

\begin{theorem}
	Sei $(B,A)\models\td$ und sei $F:B\rightarrow B$ eine $\lingua_P$-definierbare Funktion. Dann stimmt $F$ auf bis auf eine kleine Menge mit einer $\lingua$-definierbaren Funktion überein.
\end{theorem}
\begin{proof}
	TODO: Muss noch warten
\end{proof}
\begin{corollary}
	Auch jede $\lingua_P$-definierbare Menge $S\subseteq B^n$ stimmt bis auf eine kleine Menge mit einer $\lingua$-definierbaren Menge $S'$ überein. $S'$ kann man zum Beispiel finden, indem man für die $\lingua_P$-definierbare charakteristische Funktion $\chi_S$ die $\lingua$-definierbare Annäherung $f$ findet und $S':=\{f=1\}$ setzt.
\end{corollary}

\begin{lemma}
	Sei $(B,A)\models\td$ und sei $F:A^n\rightarrow A$ eine $\lingua_P$-definierbare Funktion. Dann gibt es $\lingua_A$-definierbare $f_1,\dots,f_k:A^n\rightarrow A$, sodass für alle $a\in A^n$ ein $f_i$ existiert mit $F(a)=f_i(a)$.
\end{lemma}
\begin{proof}
	Wenn die Aussage nicht gilt, gilt für alle $k\in\setN$ und alle $\lingua_A$-definierbaren $f_1,\dots,f_k:A^n\rightarrow A$, dass ein $a\in A$ existiert mit $f_i(a)\neq F(a)$ für alle $i$. Also ist der partielle Typ $$\{F(x)\neq f(x)\mid f:A^n\rightarrow A\ \lingua_A\text{-definierbar}\}$$ konsistent und es existiert $(B,A)\preceq(B',A')$ und $a'\in A'^n$ mit $F(a')\neq f(a')$ für alle $\lingua_A$-definierbaren $f:A'^n\rightarrow A'$.\\
	Allerdings ist nach Lemma \ref{Unabhängigkeitsregeln} (6.) wegen $a'\in A'^n$ die Erweiterung $(Ba',Aa')\subseteq(B',A')$ frei, nach Lemma \ref{Freie Definierbarkeit} ist $Ba'$ also $\lingua_P$-definierbar abgeschlossen. Da $F(a')$ $\lingua_P$-definierbar über $Ba'$ ist, ist es in $Ba'$, wegen $F:A'^n\rightarrow A$ ist $F(a')\in A'$. Wegen Unabhängigkeit liegt also $F(a')\in Ba'\cap A'=Aa'$ und es gibt eine $\lingua_A$-definierbare Abbildung $f:A'^n\rightarrow A'$ mit $f(a')=F(a')$ - ein Widerspruch!
\end{proof}

\section{Definierbare eindimensionale Mengen}
TODO: Hier noch einleitende Worte finden\\
In diesem Teil sei $(B,A)$ ein dichtes Paar, als Konvention nehmen wir an, dass $A^0=\{0\}$.

\begin{lemma}
	Für jede $\lingua$-definierbare Menge $S\subseteq B^m$ und Funktion $g:B^m\rightarrow B^k$ gibt es eine $\lingua$-definierbare Teilmenge $S'\subseteq S$, sodass $$A^m\cap S\cap g^{-1}(A^k)=A^m\cap S'.$$
\end{lemma}
\begin{proof}
	Für $S=\emptyset$, wähle $S'=\emptyset$. Ansonsten führen wir eine Induktion über $(m,k,\dim S)$ mit elementweiser Halbordnung (die ist fundiert):\\
	Wenn $m=0,k=0$ oder $\dim S=0$, ist $A^m\cap S\cap g^{-1}(A^k)$ endlich und daher $\lingua$-definierbar, also kann man $S'=A^m\cap S\cap g^{-1}(A^k)$ wählen. Sei also $(m,k,\dim S)>(0,0,0)$.
	\begin{itemize}
		\item Wenn $k>1$ gilt und $g$ die Koordinatenfunktionen $g_1,\dots,g_k$ hat, so existieren $(S'_i)_{i\leq k}$ mit $S'_i\subseteq S$ und $A^m\cap S\cap g_k^{-1}(A)=A^m\cap S'_i$ für alle $i$ per Induktionsvoraussetzung. Dann gilt
		\begin{align*}
		A^m\cap S\cap g^{-1}(A^k)=\bigcap\limits_{i=1}^k A^m\cap S\cap g_i^{-1}(A)=\bigcap\limits_{i=1}^k A^m\cap S'_i=A^m\cap(\bigcap\limits_{i=1}^k S'_i),
		\end{align*}
		also erfüllt $S':=\bigcap\limits_{i=1}^k S'_i$ das Gewünschte.
		\item Wenn $k=1$ gilt, zerlege $S$ in Zellen $(Z_i)$, deren Dimension natürlich $\leq\dim S$ ist. Wenn man da das Problem löst (induktiv bzw. von Hand) und jeweils ein passendes $S'_i$ findet, löst $\bigcup\limits_i S'_i$ das Problem für $S$.\\ Sei also $S$ jetzt schon eine Zelle.
		\begin{itemize}
			\item Wenn $n:=\dim S<m$ ist und $\pi$ die entsprechende homöomorphe Projektion auf eine offene Zelle in $B^n$  bzw. eine $\lingua$-definierbare Fortsetzung davon auf ganz $B^m$, sei $\lambda$ eine $\lingua$-definierbare Fortsetzung der Umkehrfunktion dieser Projektion. Wähle die Fortsetzung $\lambda$ dabei so, dass $\lambda(\pi(S))$ und $\lambda(B^n\setminus\pi(S))$ disjunkt sind. Das ermöglicht die Gleichheit $\lambda(C\cap D)=\lambda(C)\cap\lambda(D)$ für $C\subseteq\pi(S)$. Löse dann mit einem $\lingua$-definierbaren $S''\subseteq \pi(S)$ das Problem $$A^n\cap\pi(S)\cap\lambda^{-1}(A^m)\cap (g\circ\lambda)^{-1}(A)=A^n\cap S''.$$
			Das Problem entspricht im Übrigen den Anforderungen, weil man\linebreak $\lambda^{-1}(A^m)\cap (g\circ\lambda)^{-1}(A)$ wie im Fall $k>1$ umschreiben kann. Schneidet man das mit $\lambda^{-1}(A^m)$ und wendet darauf $\lambda$ an, erhält man (mit schrittweiser Verwendung des $\cap$-Herausziehens)
			\begin{align*}
			\lambda(A^n)\cap S\cap A^m\cap g^{-1}(A)&=\lambda(A^n\cap\pi(S)\cap\lambda^{-1}(A^m)\cap (g\circ\lambda)^{-1}(A))\\
			&=\lambda(\lambda^{-1}(A^m)\cap A^n\cap S'')\\
			&=A^m\cap\lambda(A^n)\cap\lambda(S''),
			\end{align*}
			wegen $A^m\cap S\subseteq\lambda(A^n)$ aufgrund der Projektionseigenschaft von $\pi$, kann man $\lambda(A^n)$ weglassen und erhält $$A^m\cap S\cap g^{-1}(A)=A^m\cap\lambda(S''),$$
			also löst $\lambda(S'')$ das Problem für $S$.
			\newpage
			\item Wenn $\dim S=m$, finde eine $\lingua_A$-definierbare Funktion $G:B^{m+n}\rightarrow B$ mit $g=G(\cdot,b)$ für ein über $A$ unabhängiges Tupel $b\in B^n$. Als nächstes betreiben wir Induktion über $n$. Wenn $n=0$, dann ist nichts zu tun, weil dann $g$ schon $A$-definierbar ist, also $g^{-1}(A)=A^m$ und man dann $S'=S$ wählen kann. Ansonsten zerlege $S$ wie schon im Beweis von Lemma \ref{Freie Definierbarkeit} in Mengen
			\begin{align*}
			S_1:=\{x\in B^{m+n}\mid&G(x_1,\dots,x_{m+n-1},\cdot)\text{ ist streng monoton wachsend }\\&\text{auf einem Intervall um }x_n\},\\S_2:=\{x\in B^{m+n}\mid&G(x_1,\dots,x_{m+n-1},\cdot)\text{ ist streng monoton fallend }\\&\text{auf einem Intervall um }x_n\},\\S_3:=\{x\in B^{m+n}\mid&G(x_1,\dots,x_{m+n-1},\cdot)\text{ ist konstant auf einem Intervall um }x_n\}
			\end{align*}
			und den Rest $S_4:=B^{m+n}\setminus(S_1\cup S_2\cup S_3)$, partitioniere diese Mengen dann noch in $A$-definierbare Zellen $(Z_i)_i$ und definiere $Z'_i:=\{x\in B\mid (x,b)\in Z_i\}$ für alle $i$. Dann ist für jede offene Zelle $G$ in der letzten Koordinate entweder streng monoton steigend, fallend oder konstant jeweils auf der ganzen Zelle; das folgt, indem analog zum Beweis von Lemma \ref{Freie Definierbarkeit} offene Zellen schon Teilmenge von $S_1,S_2$ oder $S_3$ sind, die lokale Definition dieser Mengen überträgt sich durch Supremumsbildung auf die gesamte Zelle.\\
			Löse das Problem jetzt für alle $(Z'_i)_i$, wegen $S:=\bigcup\limits_i Z'_i$ ist es dann auch für $S$ gelöst: Für nicht-offene Zellen geht das per Induktion bzw. genauso wie im vorigen Unterpunkt. Wenn $Z'_i$ nun eine offene Zelle ist, gilt für ein generisches Element $x$ über $A,b$, dass $(x,b)$ generisch von $B^{m+n}$ ist, also in $S_1\cup S_2\cup S_3$. Also ist $Z_i$ entweder in $S_1,S_2$ oder $S_3$ enthalten.
			\begin{itemize}
				\item Wenn $Z_i\subseteq S_3$ ist, definiere $$\tilde{G}(\overline{x})=z:\Leftrightarrow z=G(\overline{x},y)\text{ für ein }y\text{ mit }(\overline{x},y)\in Z_i,$$ dann gilt $g=\tilde{G}(\cdot,b_1,\dots,b_{n-1})$ und per Induktion kann man das Problem für $n-1$ lösen.
				\item Wenn $Z_i\subseteq S_1,S_2$, also $G$ auf $Z_i$ injektiv in der letzten Koordinate ist, wird das Problem durch $\emptyset$ gelöst: Denn sei $a\in A^m\cap S'_i\cap g^{-1}(A)$, also existiert $a'\in A$ mit $a'=g(a)=G(a,b)$, weil $a\in Z'_i$ ist, ist $(a,b)\in Z_i$, also ist wegen Injektivität von $G$ in der letzten Koordinate $b_n$ eindeutig bestimmt mit $(a,b)\in Z_i$ und $a'=G(a,b)$. Das ist aber $A,b_1,\dots,b_{n-1}$-definierbar, also ist $b$ nicht unabhängig über $A$.
			\end{itemize}
		\end{itemize}
	\end{itemize}
\end{proof}

\begin{lemma}
	Sei $X\subseteq B$ eine kleine Teilmenge. Dann ist $X$ eine endliche Vereinigung von Mengen $f(A^n\cap E)$ für $E$ eine offene Zelle und $f:E\rightarrow B$ eine stetige $\lingua$-definierbare Funktion.
\end{lemma}
\begin{proof}
	Wenn $X$ klein ist, existiert ein $\lingua$-definierbares $g:B^m\rightarrow B$, sodass $X\subseteq g(A^m)$. Setze $X':=g^{-1}(X)\cap A^m=(g\upharpoonright A^m)^{-1}(X)$, das ist $\lingua_P$-definierbar und es gilt $g(X')=X$ wegen $X\subseteq\operatorname{im}(g\upharpoonright A^m)$.\\
	Beweise die Aussage jetzt induktiv über $m$: Wenn $m=0$ ist, ist $X$ maximal einelementig und entweder gleich $f(\{0\})$ für eine konstante Funktion $f$ oder schon die leere Vereinigung.\\
	Wenn $m>0$ ist, schreibe $X'$ als Teilmenge von $A^m$ wegen Satz \ref{Definierbare Mengen} in der Form $Y\cap A^m$ für ein $\lingua$-definierbares $Y$. Sei eine Zerlegung $\mathfrak{Z}$ von $Y$ in Zellen gegeben, auf denen $g$ jeweils stetig ist, dann ist $$X=g(Y\cap A^m)=\bigcup\limits_{Z\in\mathfrak{Z}}g(Z\cap A^m).$$
	Für offene Zellen $Z$ ist so eine Darstellung also schon gefunden. Sei $Z$ nun eine Zelle der Dimension $d<m$ und $\pi:B^d\rightarrow B^m$ eine $\lingua$-definierbare Fortsetzung des kanonischen Homöomorphismus der entsprechenden offenen Zelle $Z'$ nach $Z$, die so gewählt ist, dass $\pi(Z')$ und $\pi(M^d\setminus Z')$ disjunkt sind. Dann gilt mit derselben Argumentation wie im letzten Beweis und mit Anwendung des daraus resultierenden Lemmas $$f(Z\cap A^m)=(f\circ\pi)(A^d\cap Z\cap\pi^{-1}(A^m))=(f\circ\pi)(A^d\cap S)$$ für ein passendes $\lingua$-definierbares $S$. Das ist dann aber schon der Fall eines kleineren $m$ und mit der Induktionsbehauptung folgt die Aussage.
\end{proof}

\begin{theorem}
	Sei $X\subseteq B$ eine $\lingua_P$-definierbare Menge. Dann existiert eine endliche Unterteilung von $B$, sodass jedes dadurch erzeugte offene Intervall $I$ entweder disjunkt zu $X$ ist, Teilmenge von $X$ ist oder $X\cap I$ dicht \& kodicht in $I$ ist. Für kleine $X$ entfällt der Fall \glqq{}Teilmenge\grqq{} natürlich.
\end{theorem}
\begin{proof}
	Die gesuchte Eigenschaft bleibt unter endlichen Vereinigungen von Mengen erhalten, man muss nur eine Verfeinerung der Unterteilung durchführen. Deswegen sei $X$ zunächst klein und nach dem letzten Lemma gegeben als $X=f(A^n\cap E)$ für ein stetiges, $\lingua$-definierbares $f:E\rightarrow B$ und eine offene Zelle $E\subseteq B^n$. Da definierbarer Zusammenhang unter definierbaren stetigen Funktionen erhalten bleibt, ist $I:=f(E)$ auch definierbar zusammenhängend, weil es $\lingua$-definierbar ist, hat es auch ein Supremum und Infimum in $B\cup\{\pm\infty\}$, ist also ein Intervall (ausnahmsweise sei hier auch ein nichtoffenes Intervall mitgemeint). Wenn $I$ endlich ist, ist auch $X$ endlich und es ist nichts zu zeigen. $X$ ist disjunkt zu $B\setminus I$, nun muss nur noch gezeigt werden, dass $X=X\cap I$ dicht und kodicht in $I$ ist, denn Dichte und Kodichte in nichtoffenen unendlichen Intervallen ist äquivalent zu Dichte und Kodichte in deren Innerem. Aber für dichte Teilmengen werden durch stetige Abbildungen auf dichte Teilmengen abgebildet; da $A^n$ dicht in $B^n$ ist, ist auch $A^n\cap E$ dicht in $E$ und folglich $X$ dicht in $I$. Andererseits muss auch das Komplement von $X$ dicht in $I$ sein, da es sonst ein Intervall ganz in $X$ gäbe, was der Kleinheit mit Lemma \ref{Kleinheit} widerspricht.\\
	Sei jetzt $X$ nicht mehr klein, dann stimmt es aber bis auf eine kleine Menge mit einer $\lingua$-definierbaren Menge $X$ überein.
\end{proof}